<div>
  <% accepted_by = @rental.accepted_by %>
  <% submitter = @rental.realizes.submitter %>

  <h2>Rental between <%= submitter.name %> and <%= accepted_by.name %>
    <span class="text-secondary">
      (#<%= @rental.id %>)
    </span>
  </h2>


  <div class="card">
    <div class="card-body d-md-flex">
      <ul class="list-unstyled mb-1">
        <li>
          <b>Status:</b> <%= @rental.status %> <%
          unless @rental.submitter_accepted?
            %> - waiting for submitter to accept the request<% end %>
        </li>
        <li>
          <b>Submitter:</b> <%= link_to @rental.realizes.submitter.name, @rental.realizes.submitter %>
        </li>
        <li>
          <b>Rental start:</b> <%= @rental_request.rental_start %> </li>
        <li>
          <b>Rental end:</b> <%= @rental_request.rental_end %>
          (days left: <%= [0, (@rental.realizes.rental_end - DateTime.current.beginning_of_day).to_i].max %>)
        </li>
      </ul>
      <div class="ms-auto">
        <%= render 'rental_mgr_buttons', rental: @rental %>
      </div>
    </div>
  </div>

  <% if @rental.swapped? %>
  <div class="row mt-3">
    <h3>Current state</h3>
    <div class="col-md mb-3">
      <h4><%= link_to submitter.name, submitter %></h4>
      <ul class="list-group">
        <% @rental.wanted_per_rentals.each do |query| %>
          <%= render 'shared/list_game_copy', game_copy: query.game_copy %>
        <% end %>
      </ul>
    </div>
    <div class="col-md mb-3">
      <h4><%= link_to accepted_by.name, accepted_by %></h4>
      <ul class="list-group">
        <% @rental.offered_per_rentals.each do |query| %>
          <%= render 'shared/list_game_copy', game_copy: query.game_copy %>
        <% end %>
      </ul>
    </div>
  </div>
    <% else %>
    <div class="row mt-3">
      <h3>Current state</h3>
      <div class="col-md mb-3">
        <ul class="list-group">
          <h4><%= link_to submitter.name, submitter %></h4>
          <% @rental.realizes.offered.each do |offered| %>
            <%= render 'shared/list_game', game: offered %>
          <% end %>
        </ul>
      </div>
      <div class="col-md mb-3">
        <h4><%= link_to accepted_by.name, accepted_by %></h4>
        <ul class="list-group">
          <% @rental.realizes.wanted.each do |wanted| %>
            <%= render 'shared/list_game', game: wanted %>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>
</div>
